NAME=observer
SERVICEPATH=/etc/init.d/
SERVICEFOLDER=Service/

DAEMONPATH=/usr/local/bin/
DAEMONFOLDER=Daemon/

SERVERFOLDER=Server/
SERVERNAME=sneak

PERMISSION=755

BUILD=build/
SRC=src/

CC=gcc
FLAGTHREAD=-pthread
COPY=cp
CHANGEPERMISSION=chmod
RUN=.

all: installInotify installInotifyServer

installInotify: inotify
	$(COPY) $(SERVICEFOLDER)$(NAME)Service $(SERVICEPATH)$(NAME)
	$(CHANGEPERMISSION) $(PERMISSION) $(SERVICEPATH)$(NAME)
	$(COPY) $(DAEMONFOLDER)$(BUILD)$(NAME) $(DAEMONPATH)$(NAME)

inotify:
	$(CC) $(DAEMONFOLDER)$(SRC)$(NAME).c $(DAEMONFOLDER)$(SRC)main.c -o $(DAEMONFOLDER)$(BUILD)$(NAME)

server:
	$(CC) $(FLAGTHREAD) $(SERVERFOLDER)$(SRC)$(SERVERNAME).c $(SERVERFOLDER)$(SRC)main.c -o $(SERVERFOLDER)$(BUILD)$(SERVERNAME)

installInotifyServer: inotify server
	$(COPY) $(SERVERFOLDER)$(BUILD)$(SERVERNAME) $(DAEMONPATH)$(SERVERNAME)
	$(COPY) $(SERVICEFOLDER)$(SERVERNAME)Service $(SERVICEPATH)$(SERVERNAME)
	$(CHANGEPERMISSION) $(PERMISSION) $(SERVICEPATH)$(SERVERNAME)
